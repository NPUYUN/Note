# 线性规划
## 定义
在一组线性约束条件的限制下，求一线性目标函数最大或最小的问题

## 线性规划模型的三要素
线性规划模型主要包括三个部分：决策变量、目标函数、约束条件

### 决策变量
决策变量是指问题中可以改变的量，例如生产多少货物，选择哪条路径等；线性规划的目标就是找到最优的决策变量。
在线性规划中决策变量包括实数变量，整数变量，0-1变量等。
- 实数变量：可以取任意实数，例如生产多少货物。
- 整数变量：只能取整数，例如生产多少台机器。
- 0-1变量：只能取0或1，例如是否选择生产货物。

### 目标函数
目标函数就是把问题中的决策目标量化，一般分为最大化目标函数和最小化目标函数
在线性规划中，目标函数为一个包含决策变量的线性函数，例如
$y = 3x_1 + 2x_2$

### 约束条件
约束条件是指问题中各种时间，空间，人力，物力等限制。
在线性规划中约束条件一般表示为一组包含决策变量的不等式，例如
$x_1 + x_2 \leq 4$
$3x_1 + 2x_2 \leq 12$
$x_1, x_2 \geq 0$

此外，决策变量的取值范围称为符号约束，例如
$x_1 \leq 4$
$x_2 \leq 3$

## 线性规划模型的数学形式
### 一般形式
线性规划模型可以用以下形式表示：
$$
\begin{aligned}
z &= \max 3x_1 + 2x_2 \\
\text{s.t.}\; & x_1 + x_2 \le 4 \\
& 3x_1 + 2x_2 \le 12 \\
& x_1,\ x_2 \ge 0
\end{aligned}
$$
上述模型也可以写成如下的矩阵形式：
$$
\begin{aligned}
z &= \max c^T x \\
\text{s.t.}\; & Ax \le b \\
& x \ge 0
\end{aligned}
$$
对于有$n$个决策变量， $m$个约束条件的线性规划模型，$c$, $x$为$n$维列向量，$A$为$m$行$n$列矩阵，$b$为$m$维列向量。

### 标准形式
线性规划的目标函数可能是最大化，也可能是最小化，约束条件的符号可能是小于等于，也可能是大于等于。
因此为了方便求解，我们通常将线性规划模型转换为标准形式，即**最小化目标函数**，**所有约束条件都是小于等于符号**。
#### 最大化目标函数
最大化目标函数可以通过将目标函数系数取相反数来转换为最小化目标函数。
例如，最大化目标函数$z = 3x_1 + 2x_2$可以转换为最小化目标函数$z = -3x_1 - 2x_2$。
#### 大于等于约束
大于等于约束可以两边乘以-1变为小于等于约束。
例如，大于等于约束$x_1 \geq 2$可以转换为小于等于约束$-x_1 \leq -2$。
#### 等于约束
等于约束可以变为一个大于等于约束和一个小于等于约束，但在编程中一般支持**直接写等式约束**，可以不进行转换。

## 使用Python求解线性规划模型
### Scipy库
Scipy库提供了求解线性规划模型的函数`linprog`，可以直接调用。
#### 基础语法如下：
```python
from scipy.optimize import linprog

# 定义目标函数系数
c = [-3, -2]

# 定义约束条件系数矩阵
A = [[1, 1], [3, 2]]

# 定义约束条件右侧向量
b = [4, 12]

# 定义决策变量的取值范围
x0_bounds = (0, None)
x1_bounds = (0, None)

# 调用linprog函数求解线性规划模型
res = linprog(c, A_ub=A, b_ub=b, bounds=[x0_bounds, x1_bounds])

# 打印求解结果
print(res)
```
代码解释：
- 定义目标函数系数$c = [-3, -2]$，表示最小化$z = -3x_1 - 2x_2$。
- 定义约束条件系数矩阵$A = [[1, 1], [3, 2]]$，表示$x_1 + x_2 \le 4$和$3x_1 + 2x_2 \le 12$。
- 定义约束条件右侧向量$b = [4, 12]$，表示$x_1 + x_2 \le 4$和$3x_1 + 2x_2 \le 12$。
- 定义决策变量$x_1$的取值范围为$[0, \infty)$，$x_2$的取值范围为$[0, \infty)$。
- 调用`linprog`函数求解线性规划模型，将结果存储在`res`变量中。

### PuLP库
PuLP库是一个用于求解线性规划问题的Python库，它提供了一种简单的方式来定义和求解线性规划模型。
#### 基础语法如下：
```python
import pulp as lp

# 定义线性规划模型
model = lp.LpProblem("LP", lp.LpMinimize)

# 定义决策变量
x1 = lp.LpVariable("x1", lowBound=0)
x2 = lp.LpVariable("x2", lowBound=0)

# 定义目标函数
model += 3*x1 + 2*x2

# 定义约束条件
model += x1 + x2 <= 4
model += 3*x1 + 2*x2 <= 12

# 求解线性规划模型
status = model.solve()

print(lp.LpStatus[status])
print(lp.value(x1))
print(lp.value(x2))
print(lp.value(model.objective))
```
代码解释：
- 定义线性规划模型`model`，目标函数为最小化$z = 3x_1 + 2x_2$。
- 决策变量$x_1$、$x_2$均为非负。
- 约束：$x_1 + x_2 \le 4$，$3x_1 + 2x_2 \le 12$。
- 调用`model.solve()`求解并输出求解状态与最优值。


### CVXPY库
CVXPY库是一个用于凸优化问题的Python库，它提供了一种简单的方式来定义和求解凸优化模型。
#### 基础语法如下：
```python
import cvxpy as cp

# 定义决策变量
x = cp.Variable(2)

# 定义目标函数
obj = cp.Minimize(3*x[0] + 2*x[1])

# 定义约束条件
constraints = [x[0] + x[1] <= 4,
               3*x[0] + 2*x[1] <= 12,
               x >= 0]

# 定义凸优化问题
prob = cp.Problem(obj, constraints)

# 求解凸优化问题
prob.solve()

# 打印求解结果
print(x.value)
print(obj.value)
```
代码解释：
- 定义决策变量$x = [x_1, x_2]$。
- 定义目标函数$z = 3x_1 + 2x_2$。
- 定义约束条件$x_1 + x_2 \le 4$和$3x_1 + 2x_2 \le 12$，以及$x_1, x_2 \ge 0$。
- 定义凸优化问题`prob`，目标函数为最小化$z = 3x_1 + 2x_2$，约束条件为$x_1 + x_2 \le 4$和$3x_1 + 2x_2 \le 12$，以及$x_1, x_2 \ge 0$。
- 调用`prob.solve()`求解凸优化问题，将结果存储在`prob`变量中。
- 打印求解结果，包括$x_1$、$x_2$和$z$的最优值。


## 一个典型的线性规划问题
某机床厂生产甲、乙两种机床，每台销售后的利润分别为4000元与3000元。生产甲机床需用A、B机器加工，加工时间分别为每台2小时和1小时：生产乙机床需用A、B、C三种机器加工，加工时间为每台各一小时。若每天可用于加工的机器时数分别为机器10小时、机器8小时和C机器7小时，问该厂应生产甲、乙机床各几台，才能使总利润最大？

### 模型构建
- 决策变量：$x_1$表示生产甲机床的台数，$x_2$表示生产乙机床的台数。
- 目标函数：$z = 4000x_1 + 3000x_2$，表示最大总利润。
- 约束条件：
  - $x_1 + x_2 \le 4$，表示每天可用于加工的机器时数为10小时。
  - $2x_1 + x_2 \le 8$，表示每天可用于加工的机器时数为8小时。
  - $x_2 \le 7$，表示每天可用于加工的机器时数为7小时。
  - $x_1, x_2 \ge 0$，表示生产数量为非负整数。

### 求解：见py文件

